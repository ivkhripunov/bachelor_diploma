\subsection{Обработка измерений}
Существует два качественно разных подхода к обработке поступающих измерений
для уточнение параметров орбиты.
Первый подход базируется на совместной обработке измерительной информации. 
Представителем данного подхода является метод наименьших квадратов (МНК).
На начальных этапах освоения космического пространства именно этот метод использовался
для восстановления орбит КА. 
С увеличением числа объектов в околоземном пространстве рос и объем ресурсов, 
требующийся для процедуры уточнения орбит.
Это привело к появлению менее трудоемких алгоритмов, основанных 
на линеаризации уравнений динамики системы и рекуррентной обработке измерений. Примером таких
алгоритмов является фильтр Калмана и его модификации.

\subsubsection{Метод наименьших квадратов}
В методе наименьших квадратов параметры орбиты $\mathbf{x}$ итеративно 
подбираются таким образом,
чтобы минимизировать взвешенную сумму квадратов невязок измерений 
$\{\mathbf{z}^O_k (t_k, \mathbf{x})\}_{k=1}^N$ 
и их расчетных аналогов $\{\mathbf{z}_k^C (t_k, \mathbf{x})\}_{k=1}^N$:

\begin{equation}
    S(\mathbf{x}) = \sum_{k=1}^{N} (\mathbf{z}^O_k - \mathbf{z}^C_k)^T W_k 
    (\mathbf{z}^O_k - \mathbf{z}^C_k) \rightarrow min,
\end{equation}
где $N$ -- число измерений, $W_k$ -- весовая симметричная матрица, $t_k$ -- момент измерения, а
расчетные аналоги строятся из прогноза движения КА на моменты измерений.

Задачу оптимизации можно переписать в виде:

\begin{equation*}
    S(\mathbf{x}) = (\mathbf{z}^O - \mathbf{z}^C)^T W (\mathbf{z}^O - \mathbf{z}^C) \rightarrow min,
\end{equation*}
где $z^C = (z_1^C, \dots, z_N^C)$, $z^O = (z_1^O, \dots, z_N^O)$, $W = diag(W_1, \dots, W_N)$.

Рассмотрим поиск минимума функционала методом Гаусса-Ньютона, также
известным как метод дифференциальной коррекции. В данном алгоритме 
используется предположение о близости начального приближения к оптимальному, что позволяет
провести линеаризацию расчетного аналога измерений:

\begin{equation*}
    \mathbf{z}^C = \mathbf{z}^N (\mathbf{x}) +  
    \frac{\partial \mathbf{z}^N (\mathbf{x})}{\partial \mathbf{x}} \Delta \mathbf{x} = 
    \mathbf{z}^N + A \Delta \mathbf{x},
\end{equation*}
где $\mathbf{z}^N$ -- номинальный вектор измерений, соответствующий состоянию системы на текущей итерации,
 $A (\mathbf{x}) = \frac{\partial z^N (\mathbf{x})}{\partial \mathbf{x}}$ -- матрица Якоби,
 $\Delta \mathbf{x}$ -- параметр линеаризации.

На каждой итерации необходимо найти такой шаг $\Delta \mathbf{x}$, который обеспечивал бы
минимум невязки. Из необходимого условия экстремума:

\begin{equation*}
    \nabla S(\mathbf{x}) = - 2 A^T (\mathbf{x}) W (\mathbf{z}^O (\mathbf{x}) - \mathbf{z}^C) = 0
\end{equation*}

\begin{equation*}
    A^T W (\mathbf{z}^O - \mathbf{z}^C) 
    = A^T W (\mathbf{z}^O - \mathbf{z}^N) - A^T W A \Delta \mathbf{x} = 0
\end{equation*}

Обозначая $\mathbf{z}^O - \mathbf{z}^N = \mathbf{b}$, получим выражение для шага:
\begin{equation}
    \Delta \mathbf{x} = (A^T W A)^{-1} A^T W \mathbf{b}
\end{equation}

Таким образом, имея начальное приближение $\mathbf{x}_{0}$, можно построить итеративную процедуру:
\begin{equation}
    \mathbf{x}_{i + 1} = \mathbf{x}_{i} + \Delta \mathbf{x}
\end{equation}

Выбор начального приближения может быть осуществлен с помощью методов начального
определения орбиты, таких как метод Гаусса, Гудинга и Double-R.

Критерий останова -- малое изменение среднеквадратичного отклонения по сравнению с предыдущей итерацией.

Матрица Якоби $A_k$ измерения $\mathbf{z}_k$ представима в виде произведения:

\begin{equation*}
    A_k(\mathbf{x}) = \frac{\partial \mathbf{z}_k (\mathbf{\tilde{x}})}{\partial \mathbf{\tilde{x}}}
    \frac{\partial \mathbf{\tilde{x}} (\mathbf{x}, t_k)}{\partial \mathbf{x}} = H_k \Phi_k,
\end{equation*}
где $\mathbf{\tilde{x}}$ -- прогноз состояния системы на момент времени $t_k$, 
а матрица $H_k$ может быть рассчитана аналитически.

Матрица изохронных производных $\Phi_k$ вычисляется 
из интегрирования уравнения в вариациях до момента времени $t_k$:
\begin{equation}
    \begin{cases}
        \dot{\Phi} = \frac{\partial \mathbf{f}}{\partial \mathbf{x}} \Phi, \\
        \Phi(t = t_0) = \Phi_0,
        \label{eq:prognoz_phi}
    \end{cases}
\end{equation}
где $\mathbf{f}$ -- правая часть системы (\ref{eq:prognoz_task}).

\subsubsection{Фильтр Калмана}

\paragraph{Расширенный фильтр Калмана}

\paragraph{Сигма-точечный фильтр Калмана}

\subsubsection{Оптимальная фильтрация измерений}